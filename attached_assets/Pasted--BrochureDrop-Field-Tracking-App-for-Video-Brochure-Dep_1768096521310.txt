# BrochureDrop â€” Field Tracking App for Video Brochure Deployment

## PROJECT OVERVIEW

Build a mobile-first Progressive Web App (PWA) called â€œBrochureDropâ€ that allows field sales representatives to track video brochure deployments. When a rep leaves a physical video brochure at a merchant location, they scan a unique QR code on the brochure, and the app automatically captures:

1. The brochureâ€™s unique ID (from the QR code)
1. GPS location (from the phone)
1. Business name and details (via reverse geocoding + places API)
1. Timestamp
1. Optional voice note with AI transcription
1. Scheduled follow-up reminder

The app then sends the rep a reminder notification when itâ€™s time to return for the pickup conversation.

-----

## CORE USER FLOW

### Flow 1: Dropping a Brochure

```
1. Rep opens app â†’ sees "Scan Brochure" button
2. Rep scans QR code on brochure â†’ camera opens, reads QR
3. App captures GPS location automatically
4. App displays: 
   - Detected address
   - Auto-suggested business name (from Google Places or similar)
   - Option to edit/correct business name
5. Rep can optionally:
   - Record a voice note (30-90 seconds)
   - Add text notes
   - Set custom follow-up date (default: 3 days)
   - Tag the business type (restaurant, retail, service, etc.)
6. Rep taps "Log Drop" â†’ record saved
7. Confirmation screen shows summary + reminder date
```

### Flow 2: Viewing Pending Pickups

```
1. Rep opens app â†’ sees dashboard with:
   - Today's pickups (urgent, highlighted)
   - Upcoming pickups (next 7 days)
   - Overdue pickups (red warning)
2. Rep taps a pickup â†’ sees full details:
   - Business name, address, map link
   - Original drop date
   - Voice note playback + transcript
   - Any text notes
3. Rep can:
   - Mark as "Picked Up" 
   - Log outcome (Signed, Interested, Not Interested, Business Closed, Couldn't Find)
   - Reschedule pickup
   - Add follow-up notes
```

### Flow 3: Completing a Pickup

```
1. Rep arrives at location
2. Opens pending pickup record
3. After conversation, taps "Log Outcome"
4. Selects outcome:
   - âœ… Signed (converted to customer)
   - ğŸ”„ Interested - Schedule Appointment
   - ğŸ“… Interested - Follow Up Later (set new date)
   - âŒ Not Interested
   - ğŸš« Business Closed/Couldn't Find
5. Optional: Record follow-up voice note
6. Save â†’ record moves to history
```

-----

## TECHNICAL REQUIREMENTS

### Stack

- **Frontend:** React with TypeScript (or Next.js)
- **Styling:** Tailwind CSS
- **Backend:** Node.js with Express (or use Replitâ€™s built-in backend)
- **Database:** SQLite for simplicity (or Replit DB / Supabase if preferred)
- **Authentication:** Simple PIN code or email magic link (keep it lightweight for field use)
- **PWA:** Must be installable on mobile home screen, work offline for viewing existing records

### External APIs Needed

1. **QR Code Scanning:** Use `html5-qrcode` library (no API needed, runs in browser)
1. **Reverse Geocoding (GPS â†’ Address):**
- Option A: Google Maps Geocoding API
- Option B: OpenStreetMap Nominatim (free, no API key)
- Option C: Mapbox Geocoding
1. **Business Lookup (Address â†’ Business Name):**
- Option A: Google Places API (Nearby Search)
- Option B: Foursquare Places API
- Option C: Yelp Fusion API
- For MVP, can skip this and let user type business name manually
1. **Voice Recording + Transcription:**
- Recording: Use browser MediaRecorder API (no external service)
- Transcription: OpenAI Whisper API
- Store audio files in Replitâ€™s file storage or link to cloud storage
1. **Push Notifications:**
- Use web push notifications (Service Worker)
- Fallback: Email reminders via SendGrid or Resend

### Environment Variables Needed

```
GOOGLE_MAPS_API_KEY=your_key_here
OPENAI_API_KEY=your_key_here  # for Whisper transcription
SENDGRID_API_KEY=your_key_here  # optional, for email reminders
```

-----

## DATABASE SCHEMA

### Table: agents

```sql
CREATE TABLE agents (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  email TEXT UNIQUE,
  phone TEXT,
  territory TEXT,
  pin_code TEXT,  -- simple 4-digit PIN for login
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### Table: brochures

```sql
CREATE TABLE brochures (
  id TEXT PRIMARY KEY,  -- e.g., "SP-2026-00147"
  batch TEXT,  -- e.g., "PILOT-FEB-2026"
  status TEXT DEFAULT 'available',  -- available, deployed, returned, lost
  created_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### Table: drops

```sql
CREATE TABLE drops (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  brochure_id TEXT NOT NULL,
  agent_id TEXT NOT NULL,
  
  -- Location data
  latitude REAL,
  longitude REAL,
  address TEXT,
  
  -- Business data
  business_name TEXT,
  business_type TEXT,  -- restaurant, retail, service, convenience, auto, other
  business_phone TEXT,
  contact_name TEXT,
  
  -- Notes
  text_notes TEXT,
  voice_note_url TEXT,
  voice_transcript TEXT,
  
  -- Timing
  dropped_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  pickup_scheduled_for DATETIME,
  pickup_reminder_sent BOOLEAN DEFAULT FALSE,
  
  -- Status tracking
  status TEXT DEFAULT 'pending',  -- pending, picked_up, converted, lost
  outcome TEXT,  -- signed, interested_appointment, interested_later, not_interested, closed, not_found
  outcome_notes TEXT,
  picked_up_at DATETIME,
  
  FOREIGN KEY (brochure_id) REFERENCES brochures(id),
  FOREIGN KEY (agent_id) REFERENCES agents(id)
);
```

### Table: reminders

```sql
CREATE TABLE reminders (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  drop_id INTEGER NOT NULL,
  agent_id TEXT NOT NULL,
  remind_at DATETIME NOT NULL,
  sent BOOLEAN DEFAULT FALSE,
  sent_at DATETIME,
  method TEXT,  -- push, email, sms
  FOREIGN KEY (drop_id) REFERENCES drops(id),
  FOREIGN KEY (agent_id) REFERENCES agents(id)
);
```

-----

## UI/UX SPECIFICATIONS

### Design Principles

1. **Mobile-first:** Design for phone screens held in one hand
1. **Large touch targets:** Buttons minimum 48px tall
1. **Fast:** Must work on spotty cell connections
1. **Minimal typing:** Use voice, dropdowns, and auto-detection wherever possible
1. **High contrast:** Readable in bright outdoor light

### Color Scheme

```
Primary: #1E40AF (SignaPay blue)
Success: #059669 (green)
Warning: #D97706 (amber)
Danger: #DC2626 (red)
Background: #F9FAFB (light gray)
Text: #111827 (near black)
```

### Key Screens

#### 1. Home / Dashboard

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BrochureDrop          [ğŸ‘¤ JM] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚     ğŸ“· SCAN & DROP      â”‚   â”‚
â”‚   â”‚                         â”‚   â”‚
â”‚   â”‚   Tap to log a new drop â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  TODAY'S PICKUPS (3)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸª Marcus Tire & Auto   â”‚   â”‚
â”‚  â”‚    4521 Ross Ave        â”‚   â”‚
â”‚  â”‚    Dropped: 3 days ago  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ• Rosa's Bakery        â”‚   â”‚
â”‚  â”‚    812 Jefferson Blvd   â”‚   â”‚
â”‚  â”‚    Dropped: 3 days ago  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  UPCOMING (7)    OVERDUE (2)   â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2. Scan & Drop Screen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Back           New Drop     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                         â”‚   â”‚
â”‚   â”‚     [CAMERA VIEWFINDER] â”‚   â”‚
â”‚   â”‚                         â”‚   â”‚
â”‚   â”‚   Point at QR code on   â”‚   â”‚
â”‚   â”‚   brochure              â”‚   â”‚
â”‚   â”‚                         â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚   Brochure ID: SP-2026-00147   â”‚
â”‚   âœ“ Scanned successfully       â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ LOCATION                    â”‚
â”‚  4521 Ross Ave, Dallas TX      â”‚
â”‚  [Edit]                        â”‚
â”‚                                 â”‚
â”‚  ğŸ¢ BUSINESS NAME               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Marcus Tire & Auto      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  Suggested: Marcus Tire & Auto â”‚
â”‚                                 â”‚
â”‚  ğŸ“ BUSINESS TYPE               â”‚
â”‚  [Auto/Repair â–¼]               â”‚
â”‚                                 â”‚
â”‚  ğŸ‘¤ CONTACT NAME (optional)     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Marcus                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¤ VOICE NOTE                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â— REC  0:23            â”‚   â”‚
â”‚  â”‚  [Stop] [Cancel]        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  ğŸ“ TEXT NOTES (optional)       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“… FOLLOW-UP IN                â”‚
â”‚  [3 days â–¼]  â†’  Tue, Feb 18    â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      âœ“ LOG THIS DROP    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. Drop Detail / Pickup Screen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Back        Drop Details    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  ğŸª Marcus Tire & Auto          â”‚
â”‚  Auto/Repair                   â”‚
â”‚                                 â”‚
â”‚  ğŸ“ 4521 Ross Ave, Dallas TX    â”‚
â”‚     [Open in Maps]             â”‚
â”‚                                 â”‚
â”‚  ğŸ“ (214) 555-0142              â”‚
â”‚     [Call]                     â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  BROCHURE: SP-2026-00147       â”‚
â”‚  DROPPED: Feb 15, 2026 10:42am â”‚
â”‚  PICKUP DUE: Feb 18, 2026      â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¤ VOICE NOTE                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â–¶ Play   0:47          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  ğŸ“ TRANSCRIPT                  â”‚
â”‚  "Owner's name is Marcus, runs â”‚
â”‚  a tire shop, been in business â”‚
â”‚  12 years. Wife handles books. â”‚
â”‚  Been burned by First Data...  â”‚
â”‚  Best time Tuesday morning."   â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   ğŸ“… RESCHEDULE PICKUP  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   âœ“ LOG PICKUP OUTCOME  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4. Outcome Selection Screen

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Back        Log Outcome     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  Marcus Tire & Auto             â”‚
â”‚  How did it go?                â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ… SIGNED - CONVERTED   â”‚   â”‚
â”‚  â”‚    They signed up!      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ“… INTERESTED -         â”‚   â”‚
â”‚  â”‚    APPOINTMENT SET      â”‚   â”‚
â”‚  â”‚    Scheduled full demo  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”„ INTERESTED -         â”‚   â”‚
â”‚  â”‚    FOLLOW UP LATER      â”‚   â”‚
â”‚  â”‚    Not ready yet        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âŒ NOT INTERESTED       â”‚   â”‚
â”‚  â”‚    They declined        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸš« COULDN'T COMPLETE    â”‚   â”‚
â”‚  â”‚    Closed/not found     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¤ ADD FOLLOW-UP NOTE          â”‚
â”‚  [Record Voice Note]           â”‚
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

-----

## API ENDPOINTS

### Authentication

```
POST /api/auth/login
  Body: { email, pin }
  Returns: { token, agent }

POST /api/auth/logout
  Headers: Authorization: Bearer <token>
```

### Drops

```
POST /api/drops
  Create a new drop
  Body: {
    brochure_id,
    latitude,
    longitude,
    address,
    business_name,
    business_type,
    contact_name,
    text_notes,
    voice_note_url,
    pickup_scheduled_for
  }

GET /api/drops
  List all drops for current agent
  Query params: status, from_date, to_date

GET /api/drops/:id
  Get single drop details

PATCH /api/drops/:id
  Update drop (reschedule, add notes)

POST /api/drops/:id/outcome
  Log pickup outcome
  Body: {
    outcome,
    outcome_notes,
    voice_note_url
  }
```

### Voice Notes

```
POST /api/voice/upload
  Upload voice recording
  Body: multipart/form-data with audio file
  Returns: { url, transcript }

GET /api/voice/:id
  Stream audio file
```

### Brochures

```
GET /api/brochures/:id
  Check if brochure ID exists and its status

POST /api/brochures/bulk
  Create batch of brochure IDs (admin only)
  Body: { prefix, start_number, count }
```

### Dashboard / Stats

```
GET /api/dashboard
  Returns: {
    today_pickups: [...],
    upcoming_pickups: [...],
    overdue_pickups: [...],
    stats: {
      total_drops,
      pending_pickups,
      conversion_rate
    }
  }
```

-----

## VOICE RECORDING & TRANSCRIPTION

### Recording Implementation

Use the browserâ€™s MediaRecorder API:

```javascript
// Start recording
const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
const mediaRecorder = new MediaRecorder(stream);
const chunks = [];

mediaRecorder.ondataavailable = (e) => chunks.push(e.data);
mediaRecorder.onstop = () => {
  const blob = new Blob(chunks, { type: 'audio/webm' });
  // Upload blob to server
};

mediaRecorder.start();

// Stop recording (call after user taps stop)
mediaRecorder.stop();
```

### Transcription with OpenAI Whisper

Server-side endpoint:

```javascript
const OpenAI = require('openai');
const openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });

async function transcribeAudio(audioFilePath) {
  const transcription = await openai.audio.transcriptions.create({
    file: fs.createReadStream(audioFilePath),
    model: "whisper-1",
  });
  return transcription.text;
}
```

-----

## GEOLOCATION & BUSINESS LOOKUP

### Get Current Location

```javascript
function getCurrentLocation() {
  return new Promise((resolve, reject) => {
    navigator.geolocation.getCurrentPosition(
      (position) => {
        resolve({
          latitude: position.coords.latitude,
          longitude: position.coords.longitude
        });
      },
      (error) => reject(error),
      { enableHighAccuracy: true, timeout: 10000 }
    );
  });
}
```

### Reverse Geocoding (Free Option with Nominatim)

```javascript
async function getAddressFromCoords(lat, lng) {
  const response = await fetch(
    `https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lng}&format=json`
  );
  const data = await response.json();
  return data.display_name;
}
```

### Business Lookup with Google Places (Optional)

```javascript
async function getNearbyBusiness(lat, lng) {
  const response = await fetch(
    `https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=${lat},${lng}&radius=50&key=${GOOGLE_API_KEY}`
  );
  const data = await response.json();
  if (data.results.length > 0) {
    return {
      name: data.results[0].name,
      address: data.results[0].vicinity,
      types: data.results[0].types
    };
  }
  return null;
}
```

-----

## QR CODE SCANNING

Use the `html5-qrcode` library:

```javascript
import { Html5QrcodeScanner } from "html5-qrcode";

function startScanner(onSuccess) {
  const scanner = new Html5QrcodeScanner("qr-reader", {
    fps: 10,
    qrbox: { width: 250, height: 250 }
  });
  
  scanner.render(
    (decodedText) => {
      // decodedText will be like "SP-2026-00147"
      onSuccess(decodedText);
      scanner.clear();
    },
    (error) => {
      // Scan error, keep trying
    }
  );
}
```

-----

## PUSH NOTIFICATIONS

### Service Worker Registration

```javascript
// In main app
if ('serviceWorker' in navigator && 'PushManager' in window) {
  const registration = await navigator.serviceWorker.register('/sw.js');
  const subscription = await registration.pushManager.subscribe({
    userVisibleOnly: true,
    applicationServerKey: VAPID_PUBLIC_KEY
  });
  // Send subscription to server
}
```

### Sending Notifications (Server)

```javascript
const webpush = require('web-push');

webpush.setVapidDetails(
  'mailto:support@signapay.com',
  VAPID_PUBLIC_KEY,
  VAPID_PRIVATE_KEY
);

async function sendPickupReminder(subscription, drop) {
  await webpush.sendNotification(subscription, JSON.stringify({
    title: 'Pickup Due Today',
    body: `Time to pick up brochure at ${drop.business_name}`,
    data: { dropId: drop.id }
  }));
}
```

-----

## SCHEDULED JOBS

Use a cron job or scheduled task to check for due reminders:

```javascript
// Run every hour
async function checkReminders() {
  const now = new Date();
  const dueReminders = await db.query(`
    SELECT r.*, d.business_name, d.address, a.email
    FROM reminders r
    JOIN drops d ON r.drop_id = d.id
    JOIN agents a ON r.agent_id = a.id
    WHERE r.remind_at <= ? AND r.sent = FALSE
  `, [now]);
  
  for (const reminder of dueReminders) {
    await sendPushNotification(reminder);
    await db.query('UPDATE reminders SET sent = TRUE, sent_at = ? WHERE id = ?', [now, reminder.id]);
  }
}
```

-----

## OFFLINE SUPPORT

For PWA offline capability:

### Service Worker Caching

```javascript
// sw.js
const CACHE_NAME = 'brochuredrop-v1';
const urlsToCache = [
  '/',
  '/index.html',
  '/styles.css',
  '/app.js'
];

self.addEventListener('install', (event) => {
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then((cache) => cache.addAll(urlsToCache))
  );
});

self.addEventListener('fetch', (event) => {
  event.respondWith(
    caches.match(event.request)
      .then((response) => response || fetch(event.request))
  );
});
```

### IndexedDB for Offline Data

Store pending drops locally when offline, sync when back online:

```javascript
// Queue drops when offline
if (!navigator.onLine) {
  await saveToIndexedDB('pendingDrops', dropData);
  showToast('Saved offline. Will sync when connected.');
}

// Sync when back online
window.addEventListener('online', async () => {
  const pendingDrops = await getFromIndexedDB('pendingDrops');
  for (const drop of pendingDrops) {
    await fetch('/api/drops', {
      method: 'POST',
      body: JSON.stringify(drop)
    });
  }
  await clearIndexedDB('pendingDrops');
  showToast('Synced successfully!');
});
```

-----

## SAMPLE DATA FOR TESTING

### Test Brochure IDs

```
SP-2026-00001
SP-2026-00002
SP-2026-00003
SP-2026-00004
SP-2026-00005
```

### Test Agent

```json
{
  "id": "agent_001",
  "name": "Demo Rep",
  "email": "demo@signapay.com",
  "pin": "1234",
  "territory": "Dallas"
}
```

### Sample Drop Data

```json
{
  "brochure_id": "SP-2026-00001",
  "business_name": "Marcus Tire & Auto",
  "business_type": "auto",
  "address": "4521 Ross Ave, Dallas, TX 75204",
  "latitude": 32.7890,
  "longitude": -96.7870,
  "contact_name": "Marcus",
  "text_notes": "Owner interested but skeptical. Wife handles finances.",
  "voice_transcript": "Owner's name is Marcus, been in business 12 years. Got burned by First Data before. Best time to return is Tuesday morning.",
  "dropped_at": "2026-02-15T10:42:00-06:00",
  "pickup_scheduled_for": "2026-02-18T09:00:00-06:00"
}
```

-----

## DEPLOYMENT CHECKLIST

1. [ ] Set up environment variables (API keys)
1. [ ] Initialize SQLite database with schema
1. [ ] Seed test brochure IDs
1. [ ] Create test agent account
1. [ ] Test QR scanning on mobile
1. [ ] Test geolocation permissions
1. [ ] Test voice recording and playback
1. [ ] Test transcription API
1. [ ] Test push notifications
1. [ ] Test offline mode
1. [ ] Generate PWA manifest and icons
1. [ ] Test â€œAdd to Home Screenâ€ on iOS and Android

-----

## FUTURE ENHANCEMENTS (V2)

1. **Admin Dashboard:** View all drops across all agents, conversion analytics
1. **Territory Mapping:** Visualize drops on a map, identify coverage gaps
1. **Route Optimization:** Suggest efficient pickup routes
1. **SMS Reminders:** Fallback for agents who donâ€™t enable push
1. **CRM Integration:** Sync signed merchants to SignaPayâ€™s main CRM
1. **Inventory Tracking:** Know how many brochures each agent has
1. **Performance Leaderboards:** Gamify drop-to-close rates

-----

## IMPORTANT NOTES

- **Mobile-first:** This will primarily be used on phones in the field
- **Simple auth:** Donâ€™t overcomplicate loginâ€”agents need quick access
- **Voice notes are critical:** This is the killer feature, make recording effortless
- **Offline resilience:** Field reps often have spotty connections
- **Battery consideration:** Donâ€™t drain battery with constant GPS polling

-----

Build this as a clean, functional MVP. Focus on the core flow:

1. Scan QR
1. Capture location + business
1. Record voice note
1. Set reminder
1. Get notification
1. Log outcome

Everything else is secondary.