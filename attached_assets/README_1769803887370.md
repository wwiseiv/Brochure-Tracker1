# PCBancard E-Sign Document Library

A comprehensive document library and e-signature workflow system for PCBancard merchant services. This application enables agents to select documents, auto-populate merchant information, and send documents for electronic signature.

## Features

### Document Library
- **6 Pre-configured Documents:**
  1. Merchant Application Quick Setup (required)
  2. Free Equipment Program Agreement (P1/P3 terminals)
  3. Equipment Purchase Agreement (with SIM card plans)
  4. PCB Download Sheet (internal use)
  5. PCI Compliance Agreement
  6. Dual Pricing Charity Program

- **Document Packages:**
  - Standard Dual Pricing (default)
  - Equipment Purchase
  - Full Application Package

### E-Signature Workflow
1. **Document Selection** - Browse library, filter by category, select packages
2. **Merchant Information** - Auto-populated form with validation
3. **Review & Send** - Summary and confirmation before sending

### Form Auto-Population
- 100+ form field mappings to merchant records
- Field types: text, email, phone, SSN, EIN, currency, date, select, checkbox, signature
- Real-time validation and formatting

## Getting Started

### Prerequisites
- Node.js 18+ 
- npm or yarn

### Installation

```bash
# Clone or download the project
cd pcbancard-esign

# Install dependencies
npm install

# Start development server
npm run dev
```

The application will be available at `http://localhost:5173`

### Building for Production

```bash
npm run build
npm run preview
```

## Replit Deployment

1. Import this project into Replit
2. Replit will auto-detect the configuration
3. Click "Run" to start the development server
4. For deployment, use the "Deploy" button in Replit

## E-Signature Provider Setup

The system supports multiple e-signature providers. We recommend **SignNow** for the best value.

### Recommended Providers

| Provider | Starting Price | Best For |
|----------|---------------|----------|
| **SignNow** (Recommended) | $8/user/month | High-volume, competitive pricing |
| DocuSign | $10/user/month | Enterprise, extensive integrations |
| HelloSign | $15/month | Simple API, easy integration |
| PandaDoc | $19/user/month | Document creation + signing |

### Configuration

Create a `.env` file with your provider credentials:

```env
# SignNow Configuration (Recommended)
VITE_ESIGN_PROVIDER=signnow
VITE_SIGNNOW_CLIENT_ID=your_client_id
VITE_SIGNNOW_CLIENT_SECRET=your_client_secret
VITE_SIGNNOW_API_KEY=your_api_key
VITE_ESIGN_ENVIRONMENT=sandbox  # or 'production'
VITE_ESIGN_WEBHOOK_URL=https://your-app.com/api/esign/webhook
VITE_ESIGN_REDIRECT_URL=https://your-app.com/esign/complete

# DocuSign Configuration (Alternative)
# VITE_ESIGN_PROVIDER=docusign
# VITE_DOCUSIGN_INTEGRATION_KEY=your_integration_key
# VITE_DOCUSIGN_SECRET_KEY=your_secret_key

# HelloSign Configuration (Alternative)
# VITE_ESIGN_PROVIDER=hellosign
# VITE_HELLOSIGN_API_KEY=your_api_key
```

## Project Structure

```
pcbancard-esign/
├── src/
│   ├── types/
│   │   └── index.ts          # TypeScript definitions
│   ├── data/
│   │   └── documentLibrary.ts # Document configurations
│   ├── services/
│   │   └── eSignatureService.ts # Provider abstraction
│   ├── utils/
│   │   └── formUtils.ts      # Form utilities
│   ├── components/
│   │   ├── DocumentCard.tsx  # Document thumbnail
│   │   ├── DocumentLibrary.tsx # Document grid
│   │   ├── QuickForm.tsx     # Auto-populated form
│   │   ├── ESignButton.tsx   # Trigger button
│   │   └── ESignModal.tsx    # Full workflow modal
│   ├── assets/
│   │   ├── images/           # Document thumbnails
│   │   └── documents/        # PDF templates
│   ├── App.tsx               # Main application
│   └── main.tsx              # Entry point
├── public/
│   └── favicon.svg
├── package.json
├── tsconfig.json
├── vite.config.ts
└── README.md
```

## API Endpoints (To Implement)

When integrating with a backend, implement these endpoints:

```typescript
// Create e-signature envelope
POST /api/esign/envelope
Body: {
  merchantId: string,
  documentIds: string[],
  signerEmail: string,
  signerName: string,
  formValues: Record<string, any>
}

// Get envelope status
GET /api/esign/envelope/:envelopeId

// Void envelope
DELETE /api/esign/envelope/:envelopeId

// Webhook for status updates
POST /api/esign/webhook
```

## Document Field Mapping

Form fields are automatically mapped from merchant records:

| Field | Mapped From |
|-------|-------------|
| DBA Name | `businessName` |
| Owner Name | `owner.firstName` + `owner.lastName` |
| Business Phone | `businessPhone` |
| Owner Email | `owner.email` |
| Business Address | `businessAddress.street`, `.city`, `.state`, `.zip` |
| Federal Tax ID | `federalTaxId` |
| SSN | `owner.ssn` |

## Extending the Library

### Adding New Documents

1. Add document image to `src/assets/images/`
2. Update `src/data/documentLibrary.ts`:

```typescript
{
  id: 'new-document',
  name: 'New Document Name',
  description: 'Description of the document',
  category: 'agreement',
  thumbnailPath: '/assets/images/new-doc.jpeg',
  isRequired: false,
  sortOrder: 7,
  createdAt: new Date(),
  updatedAt: new Date(),
  formFields: [
    {
      id: 'field_1',
      fieldName: 'fieldName',
      label: 'Field Label',
      type: 'text',
      required: true,
      mappedFrom: 'merchantRecordPath'
    }
  ]
}
```

### Adding New E-Signature Providers

Implement the `IESignatureProvider` interface in `src/services/eSignatureService.ts`:

```typescript
class NewProvider implements IESignatureProvider {
  async createEnvelope(request: ESignatureRequest): Promise<ESignatureRequest> {
    // Implementation
  }
  
  async sendEnvelope(envelopeId: string): Promise<void> {
    // Implementation
  }
  
  // ... other methods
}
```

## Integration with CRM

To integrate with your existing merchant CRM:

1. Import the `ESignButton` component
2. Pass merchant data when opening the modal
3. Handle the `onComplete` callback

```tsx
import { ESignButton } from './components/ESignButton';
import { ESignModal } from './components/ESignModal';

// In your merchant record component
<ESignButton
  merchantId={merchant.id}
  merchantName={merchant.businessName}
  onClick={(id) => setShowModal(true)}
/>

<ESignModal
  isOpen={showModal}
  onClose={() => setShowModal(false)}
  merchant={merchantData}
  onComplete={(request) => {
    // Handle completed e-sign request
    console.log('Documents sent:', request);
  }}
/>
```

## Security Considerations

- SSN and EIN fields should be encrypted in production
- Use HTTPS for all API communications
- Store API keys in environment variables only
- Implement proper authentication before allowing e-sign operations
- Consider audit logging for compliance

## Support

For questions or issues:
- PCBancard Support: (973) 324-2251
- Technical Documentation: https://docs.pcbancard.com

## License

Proprietary - PCBancard LLC
